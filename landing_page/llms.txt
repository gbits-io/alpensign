# AlpenSign

> AlpenSign is a transaction sealing solution for banks built on the Solana Seeker phone. It turns the Seeker's secure element and Solana blockchain into an independent second-channel authorization layer for bank payments â€” creating immutable, biometric-confirmed, cryptographic proof of payment authorization on a neutral public ledger.

AlpenSign was built for the Solana Seeker Hackathon Monolith (Q1 2026) by a Swiss fintech team. The core idea: the phone doesn't replace the bank's authentication â€” it independently attests that the client confirmed the transaction. This produces evidence that is not controlled by the bank, making it structurally stronger than self-serving server logs in disputes and fraud cases.

## Current Status (v0.5.4)

Working end-to-end on Solana Seeker hardware:

- âœ… WebAuthn enrollment with platform authenticator (biometric-gated ECDSA)
- âœ… MWA connection to Seed Vault Wallet via `@solana-mobile/mobile-wallet-adapter-protocol@2.2.5`
- âœ… Real wallet address from Seed Vault hardware
- âœ… Biometric-signed transaction seals (SHA-256 hash of payment details)
- âœ… Memo transactions posted to Solana devnet, signed by Seed Vault private key
- âœ… Verifiable on Solana Explorer
- âœ… Graceful degradation on non-Seeker devices (local-only proof)
- ðŸ”² Genesis Token verification (simulated)
- ðŸ”² SAS credential issuance (simulated)
- ðŸ”² Client NFT minting (simulated)
- ðŸ”² Bank confirmation flow (simulated)

## Architecture

AlpenSign implements a three-layer trust model:

1. **Genesis Token** (Layer 1 â€” Device Identity): The Seeker's soulbound NFT proves the phone is genuine hardware, verified by SKR-staked Guardians through TEEPIN. No Apple or Google attestation required.
2. **Bank Credential** (Layer 2 â€” Client Identity): The bank issues a credential via Solana Attestation Service (SAS) to the Seeker wallet, binding the client relationship to the verified device. Revocable by the bank.
3. **Transaction Seal** (Layer 3 â€” Payment Authorization): The client reviews payment details on-device, confirms with biometric. The Seeker's secure element signs and AlpenSign posts the proof to Solana. Permanent and immutable.

## Transaction Sealing Flow

1. Bank Client initiates payment via Mobile Banking App
2. Mobile Banking App sends a signing request to AlpenSign
3. AlpenSign requests a signature from Solana Seeker (biometric confirmation via Seed Vault)
4. Seeker returns the signed payload to AlpenSign
5. AlpenSign posts the seal to Solana Blockchain (SAS attestation)
6. Mobile Banking App verifies the seal on Solana

## Setup & Enrollment Flow

1. Solana Seeker connects wallet to AlpenSign via Mobile Wallet Adapter
2. AlpenSign sends enrollment request to Bank
3. Bank verifies Genesis Token and issues SAS credential on Solana
4. Bank mints a soulbound Client NFT to the Seeker wallet
5. AlpenSign is enrolled and ready to seal transactions

## Technical Implementation

### Stack

| Component | Source | Notes |
|-----------|--------|-------|
| Frontend | Vanilla HTML/JS, no framework | Single-page app, no build tools |
| Solana web3.js | unpkg IIFE `@1.98.0` | Global `solanaWeb3` object |
| MWA protocol | esm.sh ESM `@2.2.5` | Preloaded to `window.__mwaTransact` |
| WebAuthn | Browser native | Platform authenticator (Seeker secure element) |
| Solana RPC | `api.devnet.solana.com` | Blockhash, balance, confirmation |
| Hosting | HTTPS (required for MWA) | Chrome Android only |

### MWA Integration (Critical Details)

The app uses the Mobile Wallet Adapter protocol to connect to the Seeker's Seed Vault Wallet from a web page in Chrome Android. This is a non-standard integration path â€” most MWA apps are React Native or native Android.

**Key technical constraints discovered during development:**

1. **Use `chain`, not `cluster`** in `authorize()` calls. MWA v2 spec uses `chain: 'solana:devnet'`. The `cluster` alias causes silent timeouts with the Seed Vault Wallet.

2. **`identity.icon` must be a relative URI** resolved against `identity.uri`. Absolute URLs cause error `-32602`.

3. **`transact()` must fire synchronously from a click handler.** Chrome blocks `solana-wallet://` Intent navigation if the user gesture is expired. Any `await` before `transact()` kills the gesture.

4. **No network calls inside MWA sessions.** Chrome throttles backgrounded pages. Fetch blockhash and build transactions *before* calling `transact()`.

5. **Handle multiple signature return formats.** `signAndSendTransactions()` returns `{ signatures: [Uint8Array] }`, not a plain array or base64 string.

6. **Seed Vault suppresses biometric UI** if screen recording, overlays ("draw over apps"), or battery saver are active. These cause silent authorization failures.

7. **Multi-step flows need a fresh user gesture** for each MWA call. The seal flow uses a dedicated tap target at the Solana posting step.

### State Schema

```javascript
localStorage.alpensign_state = {
  enrolled: boolean,
  credId: string,           // base64 WebAuthn credential ID
  walletAddr: string,       // base58 Seed Vault wallet address
  mwaAuthToken: string,     // MWA reauthorization token
  mwaWalletUriBase: string, // custom wallet URI for faster reconnection
  seals: [{
    recipient, town, country, amount, iban, ref,
    hash,          // SHA-256 of payment details
    signature,     // WebAuthn ECDSA signature (base64)
    solanaTx,      // Solana TX signature (base58)
    solanaTxReal,  // boolean: true if posted on-chain
    deviceType,    // SOLANA_SEEKER or OTHER
    timestamp
  }],
  welcomeSeen: boolean
}
```

### What's Real vs Simulated

**Real (on Seeker with connected wallet):**
- WebAuthn credential in platform authenticator
- Biometric-gated ECDSA signature over payment hash
- MWA authorization with Seed Vault hardware
- Real Solana wallet address from Seed Vault
- Memo transaction signed by Seed Vault private key
- Transaction posted to Solana devnet
- Explorer link to real on-chain transaction

**Simulated:**
- Genesis Token verification during enrollment
- SAS credential issuance by bank
- Client NFT minting
- Bank confirmation flow

## Technology Stack

- **Seeker Seed Vault**: Hardware-isolated key storage with biometric-gated signing. Keys never leave the secure element.
- **Mobile Wallet Adapter (MWA)**: Protocol for web/native dApps to connect to MWA-compatible wallets. Uses WebSocket + Android Intent for session establishment, ECDH for encrypted communication.
- **Solana Attestation Service (SAS)**: Permissionless credential protocol from the Solana Foundation. Used for both bank credentials and transaction seals.
- **Solana Mobile Stack**: Native wallet integration, dApp runtime, and TEEPIN device verification.
- **TEEPIN + SKR Guardians**: Trusted Execution Environment Platform Infrastructure Network. SKR-staked Guardians verify device authenticity.

## Key Differentiators vs Apple / Google Devices

- On-chain device identity (Genesis Token) â€” Apple/Google have none
- Decentralized device genuineness proof (TEEPIN + Guardians) â€” vs centralized Play Integrity / DeviceCheck
- Bank credential bound to hardware wallet â€” vs no hardware binding
- Trust dependency on math + decentralized network â€” vs revocable, opaque vendor control
- No single party can revoke â€” vs vendor revocation at will

## Regulatory Alignment

- Cryptographic seals are structurally comparable to Qualified Electronic Signatures (QES) under eIDAS: identity-bound, non-repudiable, tamper-evident
- GDPR-aligned: no personal data stored on-chain, only cryptographic hashes. Biometrics stay on-device in the secure element.
- Immutable audit trail supports FINMA, MiFID II, and PSD2 Strong Customer Authentication (SCA) record-keeping requirements
- Compatible with Switzerland's ZertES (Federal Act on Electronic Signatures) and the EU eIDAS trust services framework

## Problem Statement

Banks lose billions to fraud and friendly fraud. Their only defense in disputes is server logs they generated, stored, and control â€” structurally weak self-serving evidence. SMS OTP, push notifications, and app-based 2FA all depend on bank or Big Tech infrastructure with no independent verifiable trail. The burden of proof sits with the bank. AlpenSign's independent cryptographic evidence enables a potential reversal of the burden of proof.

## Team

- **Roman** â€” Founder, Product Management, Development. 
- **Alexandr** â€” Engineering. Building the Seeker app and Solana integration layer.
- **Claude Code** â€” AI Engineering Partner. Architecture design, documentation, stakeholder analysis, and code generation (Anthropic Claude and Google Gemini).

## Licensing

- Code: Business Source License 1.1 (BSL 1.1), converting to Apache 2.0 on 2028-03-01
- Documentation: CC BY-NC-SA 4.0

## Links

- [AlpenSign Home](https://alpensign.com/)
- [AlpenSign App](https://alpensign.com/app.html)
- [MWA Debug Tool](https://alpensign.com/mwa-debug.html)
- [GitHub Repository](https://github.com/gbits-io/alpensign/)
- [Gbits.io](https://gbits.io)

## Files

- `app.html` â€” Main application shell (HTML + CSS)
- `app.js` â€” Application logic (enrollment, sealing, MWA integration, state management)
- `mwa-debug.html` â€” Standalone MWA diagnostic tool for field debugging
- `MWA_INTEGRATION_LEARNINGS.md` â€” Detailed postmortem of MWA integration challenges
- `llms.txt` â€” This file
